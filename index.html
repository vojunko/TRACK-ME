<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TRACK ME</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.css">
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="https://icons.iconarchive.com/icons/elegantthemes/beautiful-flat/256/Bar-Chart-icon.png" type="image/png">
</head>
<body>

<header>
  <div id="user-info" style="display: inline-flex; align-items: center; position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); cursor:pointer;"></div>
  <h1>TRACK ME</h1>
  <button id="login-btn" class="btn" style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); display: none;">
    Login
  </button>
  <button id="logout-btn" class="btn">
    Logout
  </button>
</header>

<main>
  <div id="loading-spinner" style="display:none;">Loading...</div>
  <div id="login-prompt">
    <h2 style="font-size: 2rem; margin-bottom: 1rem;">
      Please log in to view your personalized Spotify statistics!
    </h2>
    <button id="login-btn-prompt" class="btn" style="padding: 0.6rem 1.2rem; font-size: 1rem;">
      Login to Spotify
    </button>
  </div>
  
  <section id="user-section" hidden>
    <!-- Time range selector -->
    <div style="text-align:center; margin-bottom:1rem;">
      <label for="time-range-select" style="color:#1db954; font-weight:700; margin-right:0.5rem;">Select a time period:</label>
      <select id="time-range-select" title="Select a time period" style="padding:0.3rem 0.5rem; border-radius:0.3rem; border:1px solid #1db954; background:#121212; color:#eee;">
        <option value="short_term">Last 4 weeks</option>
        <option value="medium_term" selected>Last 6 months</option>
        <option value="long_term">All the time</option>
      </select>
    </div>

    <!-- Navigation tabs -->
    <nav>
      <button class="tab active" data-target="overview-panel">Overview</button>
      <button class="tab" data-target="artists-panel">Artists</button>
      <button class="tab" data-target="albums-panel">Albums</button>
      <button class="tab" data-target="tracks-panel">Tracks</button>
      <button class="tab" data-target="genres-panel">Genres</button>
      <button class="tab" data-target="recent-panel">Recently Played</button>
      <button class="tab" data-target="audio-features-panel">Audio Features</button>
      <button class="tab" data-target="import-panel">Import Data</button>
    </nav>

    <!-- Overview Panel -->
    <div id="overview-panel" class="panel active">
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Top Artist</h3>
          <div id="top-artist"></div>
        </div>
        <div class="stat-card">
          <h3>Top Track</h3>
          <div id="top-track"></div>
        </div>
        <div class="stat-card">
          <h3>Listening Mood</h3>
          <div id="mood-indicator"></div>
        </div>
        <div class="stat-card">
          <h3>Average Features</h3>
          <canvas id="features-radar"></canvas>
        </div>
      </div>
    </div>

    <!-- Other panels (keep your existing panels) -->
    <div id="artists-panel" class="panel">
      <div id="artists-list" class="list"></div>
    </div>
    <div id="albums-panel" class="panel">
      <div id="albums-list" class="list"></div>
    </div>
    <div id="tracks-panel" class="panel">
      <div id="tracks-list" class="list"></div>
    </div>
    <div id="genres-panel" class="panel">
      <div id="genres-list" class="list genres-list"></div>
    </div>
    <div id="recent-panel" class="panel">
      <div id="recent-list" class="list"></div>
    </div>

    <!-- Audio Features Panel -->
    <div id="audio-features-panel" class="panel">
      <div class="audio-features-container">
        <div class="audio-features-chart">
          <canvas id="audio-features-chart"></canvas>
        </div>
        <div class="audio-features-stats">
          <h3>Your Audio Personality</h3>
          <div id="audio-features-description"></div>
        </div>
      </div>
    </div>

    <!-- Import Data Panel -->
    <div id="import-panel" class="panel">
      <div class="import-container">
        <h2>Get Full Listening History</h2>
        <p>Spotify API doesn't provide complete play history. To see your full stats (like stats.fm), you need to import your data:</p>
        
        <div class="import-steps">
          <div class="step">
            <h3>Step 1: Request Your Data from Spotify</h3>
            <ol>
              <li>Go to <a href="https://www.spotify.com/account/privacy/" target="_blank">Spotify Privacy Settings</a></li>
              <li>Scroll down to "Download your data"</li>
              <li>Click "Request data"</li>
              <li>Wait for email from Spotify (takes up to 30 days)</li>
            </ol>
          </div>
          
          <div class="step">
            <h3>Step 2: Upload Your Data</h3>
            <p>When you receive your data:</p>
            <div class="upload-area" id="upload-area">
              <input type="file" id="data-upload" accept=".json,.zip" multiple style="display: none;">
              <label for="data-upload" class="upload-btn">Choose files</label>
              <p>or drag and drop files here</p>
              <p class="small">Look for files named "endsong_X.json" or "StreamingHistory_X.json"</p>
            </div>
            <div id="upload-progress"></div>
          </div>
          
          <div class="step">
            <h3>Step 3: View Full Statistics</h3>
            <p>After processing, you'll see:</p>
            <ul>
              <li>Complete listening history</li>
              <li>Exact play counts</li>
              <li>Historical trends</li>
              <li>Detailed time analysis</li>
            </ul>
          </div>
        </div>
        
        <div id="imported-data-stats" style="display: none;">
          <h3>Your Imported Statistics</h3>
          <div id="imported-stats-container"></div>
        </div>
      </div>
    </div>
  </section>
</main>

<div id="toast"></div>

<footer>
  <p class="footer">Using Spotify WEB API | Â© 2025 vojunko</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
<script src="app.js"></script>
</body>
</html>
